<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0">
  <meta name="description" content="">
  <meta name="author" content="">
  <link rel="shortcut icon" href="{$Think.const.RESOURCE_URL}images/favicon.png" type="image/png">

  <title>Bracket Responsive Bootstrap3 Admin</title>
<link rel="stylesheet" href="{$Think.const.RESOURCE_URL}css/my_style.css">
  <link rel="stylesheet" href="{$Think.const.RESOURCE_URL}css/style.default.css">
  <link rel="stylesheet" href="{$Think.const.RESOURCE_URL}css/bootstrap-fileupload.min.css" />
  <link rel="stylesheet" href="{$Think.const.RESOURCE_URL}css/bootstrap-datetimepicker.min.css" />
  <link rel="stylesheet" href="{$Think.const.RESOURCE_URL}css/jquery.tagsinput.css" />
  <link rel="stylesheet" href="{$Think.const.RESOURCE_URL}css/colorpicker.css" />
  <link rel="stylesheet" href="{$Think.const.RESOURCE_URL}css/dropzone.css" />
  <link rel="stylesheet" href="{$Think.const.RESOURCE_URL}css/jquery.datatables.css">
  
<include file="Common/common_js" />
  <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
  <!--[if lt IE 9]>
  <script src="{$Think.const.RESOURCE_URL}js/html5shiv.js"></script>
  <script src="{$Think.const.RESOURCE_URL}js/respond.min.js"></script>
  <![endif]-->
</head>

<body style="overflow: visible;">

<section>

<include file="Common/sidebar" />

<div class="mainpanel">

	<include file="Common/headbar" />

	<div class="contentpanel">

		<div class="row">

        <div class="col-md-11">
          <div class="panel-body">

            <form class="form-inline" method="post" action="">              
              <div class="form-group col-md-4"> 
                <label class="col-sm-4" style="margin-top: 11px;font-size: 20px;">查询日期:</label>
                <div class="input-group">
                  <input name="queryDate" type="text" class="form-control datepicker" placeholder="查询日期" id="datepicker" value="{$queryDate}">
                  <span class="input-group-addon"><i class="glyphicon glyphicon-calendar"></i></span>
                </div>                
              </div>              
              <button type="submit" class="btn btn-primary">搜索</button>
              
            </form>
            </div>
          <div class="panel panel-info">
            <div class="panel-heading">
              <div class="panel-btns">
                <a href="" class="panel-close">&times;</a>
                <a href="" class="minimize">&minus;</a>
              </div><!-- panel-btns -->
              <h3 class="panel-title">资源消耗概况</h3>
            </div>
          </div><!-- panel -->
        </div><!-- col-md-11 -->
        
        <div class="col-md-11 mb30">		    
  		    <div id="piechart" style="width: 100%; height: 370px"></div>
		    </div><!-- col-md-6 -->
       
      <div class="col-md-6">
        <notempty name="hlist">
          <div class="table-responsive">
              <table class="table table-info mb30">
                  <thead>
                    <tr>                      
                      <th>时间</th>
                      <th>人数</th>                      
                    </tr>
                  </thead>
                  <tbody>
                  <assign name="total" value="0" />
                  <foreach name="hlist" item="item" key="hour">
                  <if condition="$item gt 0">
                    <tr>                     
                      <td><b>{$hour}时</b></td>
                      <td>{$item}人</td> 
                      <?php $total+=$item; ?>                     
                    </tr>
                  </if>
                  </foreach>
                    <tr>
                      <td><b>总计：</b></td>
                      <td>{$total}人</td>
                    </tr>
                  </tbody>
              </table>
          </div><!-- table-responsive -->
          </notempty>
          <empty name="hlist">
          <div class="table-responsive">
            <center>没有相关数据记录</center>
          </div>
          </empty>
        </div>
		</div> <!-- end of row -->
	</div> <!-- end of contentpanel -->
</div> <!-- end of mainpanel -->

</section>


<script src="{$Think.const.RESOURCE_URL}js/modernizr.min.js"></script>
<script src="{$Think.const.RESOURCE_URL}js/jquery.sparkline.min.js"></script>
<script src="{$Think.const.RESOURCE_URL}js/toggles.min.js"></script>
<script src="{$Think.const.RESOURCE_URL}js/retina.min.js"></script>
<script src="{$Think.const.RESOURCE_URL}js/jquery.cookies.js"></script>
<script src="{$Think.const.RESOURCE_URL}js/highcharts/highcharts.js"></script>
<script src="{$Think.const.RESOURCE_URL}js/highcharts/modules/exporting.js"></script>

<script src="{$Think.const.RESOURCE_URL}js/bootstrap-datetimepicker.min.js"></script>
<script src="{$Think.const.RESOURCE_URL}js/bootstrap-datetimepicker.zh-CN.js"></script>
<script src="{$Think.const.RESOURCE_URL}js/jquery.maskedinput.min.js"></script>
<script src="{$Think.const.RESOURCE_URL}js/jquery.mousewheel.js"></script>
<script src="{$Think.const.RESOURCE_URL}js/dropzone.min.js"></script>
<script src="{$Think.const.RESOURCE_URL}js/custom.js"></script>

<assign name="colors" value="$Think.config.GRAPH_PIE_COLORS" />

<script>
jQuery(document).ready(function(){
	// Chosen Select
    jQuery(".chosen-select").chosen({'width':'100%','white-space':'nowrap'});
    jQuery('.datepicker').datetimepicker({
      format: 'yyyy-mm-dd',
      language:  'zh-CN',
      autoclose: 1,
      todayHighlight: 1,
      startView: 2,
      minView: 2,
      forceParse: 0
    });

     $('#piechart').highcharts({
    chart: {zoomType: 'x', spacingRight: 20},
    title: {text: '实时创建人数'},
    subtitle: {text: document.ontouchstart === undefined ?'实时创建' :'创建'},
    xAxis: {type: 'datetime', maxZoom: 24 * 3600000, title: {text: null}
      ,labels: {formatter: function() {return  Highcharts.dateFormat('%Y-%m-%d',this.value)+' <br><span style="color:red;">'+Highcharts.dateFormat('%H',this.value)+' 时</span>';}} 
    },
    yAxis: {title: {text: '创建人数'},allowDecimals: false
        ,labels : {formatter : function() {if (this.value>=0){return this.value;} }}
    },
    tooltip: {shared: true,formatter: function() {return Highcharts.dateFormat('%Y-%m-%d %H:%M', this.x) +'<br>'+ this.y +' 人';}},
    legend: {enabled: false},
    plotOptions: {
      area: {
        fillColor: {
          linearGradient: { x1: 0, y1: 0, x2: 0, y2: 1},
          stops: [
            [0, Highcharts.getOptions().colors[0]],
            [1, Highcharts.Color(Highcharts.getOptions().colors[0]).setOpacity(0).get('rgba')]
          ]
        },
        lineWidth: 1,
        marker: {enabled: false},
        shadow: false,
        states: {hover: {lineWidth: 1}},
        threshold: null
      }
    },
    credits: {enabled: false},
    series: [{ type: 'area', name: '在线', pointInterval: 60 * 1000, 
      
     <?php $timestmp = strtotime($queryDate); ?>
      pointStart: Date.UTC({$timestmp|date="Y",###},{$timestmp|date="m",###}-1,{$timestmp|date="d",###}),
      data: <?php echo json_encode(array_values($mlist)); ?> }]

  });
   
});
</script>
</body>
</html>